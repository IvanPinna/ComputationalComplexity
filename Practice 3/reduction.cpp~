#include <iostream>
#include <vector>
#include <fstream> 
#include <string>
#include <cstdlib>

using namespace std;

void visualizar_vectores(const vector<int>& nodos, const vector<vector<int>>& conexiones)
{
  for(size_t i = 0; i < nodos.size(); ++i)
  {
    cout << nodos[i] << ":";
    for(size_t j = 0; j < conexiones[i].size(); ++j)
      cout << conexiones[i][j] << ",";
    cout << " " << endl;
  }
}


void leer_fichero(vector<int>& nodos, vector<vector<int>>& conexiones)
{
  string str, delimiter = ":";
  bool bandera;
  ifstream fe("grafo");

  size_t pos, contador = 0;
  int nodo;
  while(getline(fe, str))
  {
    cout << str << endl;
    bandera = true;
    delimiter = ":";
    while(!str.empty()) //Split by spaces
    {
      if(bandera)
      {
	pos = str.find(delimiter);
	nodo = atoi(str.substr(0,pos).c_str());
	nodos.push_back(nodo);
	conexiones.push_back(vector<int>()); 
	str.erase(0, pos + 1);
	bandera = false;
	delimiter = ",";
      }

      pos = str.find(delimiter);
      //cout << "conexion: " << str.substr(0,pos) << endl;
      conexiones[contador].push_back(atoi(str.substr(0,pos).c_str()));
      str.erase(0, pos + 1); //En este caso delimiter vale 1
    }
    ++contador;
  }
}

int main()
{
  vector<int> nodos;
  vector<vector<int> > conexiones;
  leer_fichero(nodos, conexiones);
  visualizar_vectores(nodos, conexiones);
}
